import{_ as s,c as i,o as a,a4 as t}from"./chunks/framework.K9vKjHgL.js";const n="/docs/assets/springtask-747c6f2e-66bc-4e3e-b81a-b0416ea4bb9d.D2lKsuhA.png",h="/docs/assets/springtask-54773f3f-ad58-44d5-a94a-8543f14f8c57.CgfgajHT.png",l="/docs/assets/springtask-825fd59c-d2cd-471d-a9a9-ee1194cbfc51.C8J0W940.png",u=JSON.parse('{"title":"Spring Boot æ•´åˆ Spring Task å®ç°å®šæ—¶ä»»åŠ¡","description":"","frontmatter":{"category":["Javaä¼ä¸šçº§å¼€å‘"],"tag":["Spring Boot"],"title":"Spring Boot æ•´åˆ Spring Task å®ç°å®šæ—¶ä»»åŠ¡"},"headers":[],"relativePath":"backend/tobetter/springboot/springtask.md","filePath":"backend/tobetter/springboot/springtask.md"}'),k={name:"backend/tobetter/springboot/springtask.md"},e=t(`<p>å®šæ—¶ä»»åŠ¡çš„åº”ç”¨åœºæ™¯å…¶å®è›®å¸¸è§çš„ï¼š</p><ul><li>æ•°æ®å¤‡ä»½</li><li>è®¢å•æœªæ”¯ä»˜åˆ™è‡ªåŠ¨å–æ¶ˆ</li><li>å®šæ—¶çˆ¬å–æ•°æ®</li><li>å®šæ—¶æ¨é€ä¿¡æ¯</li><li>å®šæ—¶å‘å¸ƒæ–‡ç« </li><li>å®šæ—¶ç”ŸæˆæŠ¥è¡¨</li><li>ç­‰ç­‰ï¼ˆæƒ³ä¸åˆ°å…¶ä»–åœºæ™¯äº†ï¼Œå°±åªèƒ½ç­‰ç­‰æ¥å‡‘ï¼Œç­‰ç­‰ä¹Ÿç®—æ˜¯ä¸€ç§å®šæ—¶çš„åœºæ™¯å§ï¼ï¼‰</li></ul><h3 id="timer" tabindex="-1">Timer <a class="header-anchor" href="#timer" aria-label="Permalink to &quot;Timer&quot;">â€‹</a></h3><p>JDK 1.3 å°±å¼€å§‹æ”¯æŒçš„ä¸€ç§å®šæ—¶ä»»åŠ¡çš„å®ç°æ–¹å¼ã€‚å†…éƒ¨é€šè¿‡ TaskQueue çš„ç±»æ¥å­˜æ”¾å®šæ—¶ä»»åŠ¡ï¼Œç”¨èµ·æ¥æ¯”è¾ƒç®€å•ï¼Œä½†ç¼ºé™·æ¯”è¾ƒå¤šï¼Œæ¯”å¦‚è¯´ä¸€ä¸ª Timer å°±ä¼šèµ·ä¸€ä¸ªçº¿ç¨‹ï¼Œä»»åŠ¡å¤šäº†æ€§èƒ½å°±éå¸¸å·®ï¼Œå†æ¯”å¦‚è¯´å¦‚æœæ‰§è¡Œä»»åŠ¡æœŸé—´æŸä¸ª TimerTask è€—æ—¶æ¯”è¾ƒä¹…ï¼Œå°±ä¼šå½±å“å…¶ä»–ä»»åŠ¡çš„è°ƒåº¦ã€‚</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki shiki-themes github-light dracula-soft vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">@</span><span style="--shiki-light:#D73A49;--shiki-dark:#97E1F1;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">Slf4j</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F286C4;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F286C4;"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#97E1F1;"> TimerDemo</span><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F286C4;">    public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F286C4;"> static</span><span style="--shiki-light:#D73A49;--shiki-dark:#97E1F1;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"> void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#62E884;"> main</span><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#97E1F1;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">String</span><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">[] </span><span style="--shiki-light:#E36209;--shiki-dark:#FFB86C;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">args</span><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#97E1F1;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">        TimerTask</span><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;"> task </span><span style="--shiki-light:#D73A49;--shiki-dark:#F286C4;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F286C4;--shiki-light-font-weight:inherit;--shiki-dark-font-weight:bold;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#62E884;"> TimerTask</span><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">() {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">            @</span><span style="--shiki-light:#D73A49;--shiki-dark:#97E1F1;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">Override</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F286C4;">            public</span><span style="--shiki-light:#D73A49;--shiki-dark:#97E1F1;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"> void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#62E884;"> run</span><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">() {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">                log.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#62E884;">debug</span><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#DEE492;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#E7EE98;">å½“å‰æ—¶é—´{}çº¿ç¨‹åç§°{}</span><span style="--shiki-light:#032F62;--shiki-dark:#DEE492;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">, DateTime.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#62E884;">now</span><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">(),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">                        Thread.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#62E884;">currentThread</span><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">().</span><span style="--shiki-light:#6F42C1;--shiki-dark:#62E884;">getName</span><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">());</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">            }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">        };</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">        log.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#62E884;">debug</span><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#DEE492;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#E7EE98;">å½“å‰æ—¶é—´{}çº¿ç¨‹åç§°{}</span><span style="--shiki-light:#032F62;--shiki-dark:#DEE492;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">, DateTime.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#62E884;">now</span><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">(),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">                Thread.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#62E884;">currentThread</span><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">().</span><span style="--shiki-light:#6F42C1;--shiki-dark:#62E884;">getName</span><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">());</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#97E1F1;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">        Timer</span><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;"> timer </span><span style="--shiki-light:#D73A49;--shiki-dark:#F286C4;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F286C4;--shiki-light-font-weight:inherit;--shiki-dark-font-weight:bold;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#62E884;"> Timer</span><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#DEE492;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#E7EE98;">TimerDemo</span><span style="--shiki-light:#032F62;--shiki-dark:#DEE492;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">        timer.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#62E884;">schedule</span><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">(task,</span><span style="--shiki-light:#005CC5;--shiki-dark:#BF9EEE;">1000L</span><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">}</span></span></code></pre></div><p>ä»£ç è·‘èµ·æ¥åçš„æ—¥å¿—å¦‚ä¸‹æ‰€ç¤ºï¼š</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light dracula-soft vp-code"><code><span class="line"><span>13:11:45.268 [main] DEBUG top.springtask.TimerDemo - å½“å‰æ—¶é—´2022-04-27 13:11:45çº¿ç¨‹åç§°main</span></span>
<span class="line"><span>13:11:46.280 [TimerDemo] DEBUG top.springtask.TimerDemo - å½“å‰æ—¶é—´2022-04-27 13:11:46çº¿ç¨‹åç§°TimerDemo</span></span></code></pre></div><h3 id="scheduledthreadpoolexecutor" tabindex="-1">ScheduledThreadPoolExecutor <a class="header-anchor" href="#scheduledthreadpoolexecutor" aria-label="Permalink to &quot;ScheduledThreadPoolExecutor&quot;">â€‹</a></h3><p>JDK 1.5 å¼€å§‹æä¾›çš„çš„å®šæ—¶ä»»åŠ¡ï¼Œå®ƒç»§æ‰¿äº† ThreadPoolExecutorï¼Œå®ç°äº† ScheduledExecutorService æ¥å£ï¼Œæ‰€ä»¥æ”¯æŒå¹¶å‘åœºæ™¯ä¸‹çš„ä»»åŠ¡æ‰§è¡Œã€‚åŒæ—¶ï¼Œä¼˜åŒ–äº† Timer çš„ç¼ºé™·ã€‚ä¸è¿‡ï¼Œç”±äºä½¿ç”¨äº†é˜Ÿåˆ—æ¥å®ç°å®šæ—¶å™¨ï¼Œå°±æœ‰å‡ºå…¥é˜Ÿåˆ—ã€è°ƒæ•´å †ç­‰æ“ä½œï¼Œæ‰€ä»¥å®šæ—¶ä¸æ˜¯éå¸¸éå¸¸å‡†ç¡®ï¼ˆå¹æ¯›æ±‚ç–µï¼‰ã€‚</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki shiki-themes github-light dracula-soft vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">@</span><span style="--shiki-light:#D73A49;--shiki-dark:#97E1F1;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">Slf4j</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F286C4;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F286C4;"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#97E1F1;"> ScheduledThreadPoolExecutorDemo</span><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F286C4;">    public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F286C4;"> static</span><span style="--shiki-light:#D73A49;--shiki-dark:#97E1F1;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"> void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#62E884;"> main</span><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#97E1F1;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">String</span><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">[] </span><span style="--shiki-light:#E36209;--shiki-dark:#FFB86C;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">args</span><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F286C4;">throws</span><span style="--shiki-light:#24292E;--shiki-dark:#97E1F1;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"> InterruptedException</span><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#97E1F1;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">        TimerTask</span><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;"> task </span><span style="--shiki-light:#D73A49;--shiki-dark:#F286C4;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F286C4;--shiki-light-font-weight:inherit;--shiki-dark-font-weight:bold;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#62E884;"> TimerTask</span><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">() {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">            @</span><span style="--shiki-light:#D73A49;--shiki-dark:#97E1F1;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">Override</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F286C4;">            public</span><span style="--shiki-light:#D73A49;--shiki-dark:#97E1F1;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"> void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#62E884;"> run</span><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">() {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">                log.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#62E884;">debug</span><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#DEE492;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#E7EE98;">å½“å‰æ—¶é—´{}çº¿ç¨‹åç§°{}</span><span style="--shiki-light:#032F62;--shiki-dark:#DEE492;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">, DateTime.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#62E884;">now</span><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">(),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">                        Thread.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#62E884;">currentThread</span><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">().</span><span style="--shiki-light:#6F42C1;--shiki-dark:#62E884;">getName</span><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">());</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">            }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">        };</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">        log.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#62E884;">debug</span><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#DEE492;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#E7EE98;">å½“å‰æ—¶é—´{}çº¿ç¨‹åç§°{}</span><span style="--shiki-light:#032F62;--shiki-dark:#DEE492;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">, DateTime.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#62E884;">now</span><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">(),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">                Thread.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#62E884;">currentThread</span><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">().</span><span style="--shiki-light:#6F42C1;--shiki-dark:#62E884;">getName</span><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">());</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#97E1F1;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">        ScheduledExecutorService</span><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;"> executorService </span><span style="--shiki-light:#D73A49;--shiki-dark:#F286C4;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;"> Executors.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#62E884;">newScheduledThreadPool</span><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#BF9EEE;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">        executorService.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#62E884;">scheduleAtFixedRate</span><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">(task, </span><span style="--shiki-light:#005CC5;--shiki-dark:#BF9EEE;">1000L</span><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#BF9EEE;">1000L</span><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">, TimeUnit.MILLISECONDS);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">        Thread.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#62E884;">sleep</span><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#BF9EEE;">1000</span><span style="--shiki-light:#D73A49;--shiki-dark:#F286C4;">+</span><span style="--shiki-light:#005CC5;--shiki-dark:#BF9EEE;">1000</span><span style="--shiki-light:#D73A49;--shiki-dark:#F286C4;">*</span><span style="--shiki-light:#005CC5;--shiki-dark:#BF9EEE;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">        executorService.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#62E884;">shutdown</span><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">}</span></span></code></pre></div><p>è¾“å‡ºç»“æœå¦‚ä¸‹æ‰€ç¤ºï¼š</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light dracula-soft vp-code"><code><span class="line"><span>14:43:41.740 [main] DEBUG top.springtask.ScheduledThreadPoolExecutorDemo - å½“å‰æ—¶é—´2022-04-27 14:43:41çº¿ç¨‹åç§°main</span></span>
<span class="line"><span>14:43:42.752 [pool-1-thread-1] DEBUG top.springtask.ScheduledThreadPoolExecutorDemo - å½“å‰æ—¶é—´2022-04-27 14:43:42çº¿ç¨‹åç§°pool-1-thread-1</span></span>
<span class="line"><span>14:43:43.748 [pool-1-thread-1] DEBUG top.springtask.ScheduledThreadPoolExecutorDemo - å½“å‰æ—¶é—´2022-04-27 14:43:43çº¿ç¨‹åç§°pool-1-thread-1</span></span>
<span class="line"><span>14:43:44.749 [pool-1-thread-2] DEBUG top.springtask.ScheduledThreadPoolExecutorDemo - å½“å‰æ—¶é—´2022-04-27 14:43:44çº¿ç¨‹åç§°pool-1-thread-2</span></span>
<span class="line"><span>14:43:45.749 [pool-1-thread-2] DEBUG top.springtask.ScheduledThreadPoolExecutorDemo - å½“å‰æ—¶é—´2022-04-27 14:43:45çº¿ç¨‹åç§°pool-1-thread-2</span></span>
<span class="line"><span>14:43:46.749 [pool-1-thread-2] DEBUG top.springtask.ScheduledThreadPoolExecutorDemo - å½“å‰æ—¶é—´2022-04-27 14:43:46çº¿ç¨‹åç§°pool-1-thread-2</span></span></code></pre></div><h3 id="å…³äº-spring-task" tabindex="-1">å…³äº Spring Task <a class="header-anchor" href="#å…³äº-spring-task" aria-label="Permalink to &quot;å…³äº Spring Task&quot;">â€‹</a></h3><p>Spring Task æ˜¯ Spring æä¾›çš„è½»é‡çº§å®šæ—¶ä»»åŠ¡å·¥å…·ï¼Œä¹Ÿå°±æ„å‘³ç€ä¸éœ€è¦å†æ·»åŠ ç¬¬ä¸‰æ–¹ä¾èµ–äº†ï¼Œç›¸æ¯”å…¶ä»–ç¬¬ä¸‰æ–¹ç±»åº“æ›´åŠ æ–¹ä¾¿æ˜“ç”¨ã€‚</p><p>å¥½åƒå…³äº Spring Taskï¼Œæ²¡æœ‰å…¶ä»–åºŸè¯å¯è¯´äº†ï¼Œæˆ‘ä»¬æ¥ç›´æ¥ä¸Šæ‰‹ã€‚</p><p>ç¬¬ä¸€æ­¥ï¼Œæ–°å»ºé…ç½®ç±» SpringTaskConfigï¼Œå¹¶æ·»åŠ  @EnableSchedulingæ³¨è§£å¼€å¯ Spring Taskã€‚</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki shiki-themes github-light dracula-soft vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">@</span><span style="--shiki-light:#D73A49;--shiki-dark:#97E1F1;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">Configuration</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">@</span><span style="--shiki-light:#D73A49;--shiki-dark:#97E1F1;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">EnableScheduling</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F286C4;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F286C4;"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#97E1F1;"> SpringTaskConfig</span><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">}</span></span></code></pre></div><p>å½“ç„¶äº†ï¼Œä¹Ÿå¯ä»¥ä¸æ–°å»ºè¿™ä¸ªé…ç½®ç±»ï¼Œç›´æ¥åœ¨ä¸»ç±»ä¸Šæ·»åŠ  @EnableScheduling æ³¨è§£ã€‚</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki shiki-themes github-light dracula-soft vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">@</span><span style="--shiki-light:#D73A49;--shiki-dark:#97E1F1;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">SpringBootApplication</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">@</span><span style="--shiki-light:#D73A49;--shiki-dark:#97E1F1;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">EnableScheduling</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F286C4;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F286C4;"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#97E1F1;"> CodingmoreSpringtaskApplication</span><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;"> {</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F286C4;">	public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F286C4;"> static</span><span style="--shiki-light:#D73A49;--shiki-dark:#97E1F1;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"> void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#62E884;"> main</span><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#97E1F1;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">String</span><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">[] </span><span style="--shiki-light:#E36209;--shiki-dark:#FFB86C;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">args</span><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">		SpringApplication.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#62E884;">run</span><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">(CodingmoreSpringtaskApplication.class, args);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">	}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">}</span></span></code></pre></div><p>ç¬¬äºŒæ­¥ï¼Œæ–°å»ºå®šæ—¶ä»»åŠ¡ç±» CronTaskï¼Œä½¿ç”¨ @Scheduled æ³¨è§£æ³¨å†Œ Cron è¡¨è¾¾å¼æ‰§è¡Œå®šæ—¶ä»»åŠ¡ã€‚</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki shiki-themes github-light dracula-soft vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">@</span><span style="--shiki-light:#D73A49;--shiki-dark:#97E1F1;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">Slf4j</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">@</span><span style="--shiki-light:#D73A49;--shiki-dark:#97E1F1;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">Component</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F286C4;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F286C4;"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#97E1F1;"> CronTask</span><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">    @</span><span style="--shiki-light:#D73A49;--shiki-dark:#97E1F1;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">Scheduled</span><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#BF9EEE;">cron</span><span style="--shiki-light:#D73A49;--shiki-dark:#F286C4;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#DEE492;"> &quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#E7EE98;">0/1 * * ? * ?</span><span style="--shiki-light:#032F62;--shiki-dark:#DEE492;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F286C4;">    public</span><span style="--shiki-light:#D73A49;--shiki-dark:#97E1F1;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"> void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#62E884;"> cron</span><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">() {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">        log.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#62E884;">info</span><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#DEE492;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#E7EE98;">å®šæ—¶æ‰§è¡Œï¼Œæ—¶é—´{}</span><span style="--shiki-light:#032F62;--shiki-dark:#DEE492;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">, DateUtil.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#62E884;">now</span><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">());</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">}</span></span></code></pre></div><p>å¯åŠ¨æœåŠ¡å™¨ç«¯ï¼Œå‘ç°æ¯éš”ä¸€ç§’é’Ÿä¼šæ‰“å°ä¸€æ¬¡æ—¥å¿—ï¼Œè¯æ˜ Spring Task çš„ cron è¡¨è¾¾å¼å½¢å¼å·²ç»èµ·æ•ˆäº†ã€‚</p><img src="`+n+`"><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œ@Scheduled åˆ›å»ºçš„çº¿ç¨‹æ± å¤§å°ä¸º 1ï¼Œå¦‚æœæƒ³å¢åŠ çº¿ç¨‹æ± å¤§å°çš„è¯ï¼Œå¯ä»¥è®© SpringTaskConfig ç±»å®ç° SchedulingConfigurer æ¥å£ï¼Œé€šè¿‡ setPoolSize å¢åŠ çº¿ç¨‹æ± å¤§å°ã€‚</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki shiki-themes github-light dracula-soft vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">@</span><span style="--shiki-light:#D73A49;--shiki-dark:#97E1F1;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">Configuration</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">@</span><span style="--shiki-light:#D73A49;--shiki-dark:#97E1F1;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">EnableScheduling</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F286C4;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#F286C4;"> class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#97E1F1;"> SpringTaskConfig</span><span style="--shiki-light:#D73A49;--shiki-dark:#F286C4;"> implements</span><span style="--shiki-light:#6F42C1;--shiki-dark:#97E1F1;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"> SchedulingConfigurer</span><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">    @</span><span style="--shiki-light:#D73A49;--shiki-dark:#97E1F1;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">Override</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F286C4;">    public</span><span style="--shiki-light:#D73A49;--shiki-dark:#97E1F1;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"> void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#62E884;"> configureTasks</span><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">(</span><span style="--shiki-light:#24292E;--shiki-dark:#97E1F1;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">ScheduledTaskRegistrar</span><span style="--shiki-light:#E36209;--shiki-dark:#FFB86C;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"> taskRegistrar</span><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#97E1F1;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">        ThreadPoolTaskScheduler</span><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;"> threadPoolTaskScheduler </span><span style="--shiki-light:#D73A49;--shiki-dark:#F286C4;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F286C4;--shiki-light-font-weight:inherit;--shiki-dark-font-weight:bold;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#62E884;"> ThreadPoolTaskScheduler</span><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">        threadPoolTaskScheduler.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#62E884;">setPoolSize</span><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#BF9EEE;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">        threadPoolTaskScheduler.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#62E884;">setThreadNamePrefix</span><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#DEE492;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#E7EE98;">my-scheduled-task-pool-</span><span style="--shiki-light:#032F62;--shiki-dark:#DEE492;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">        threadPoolTaskScheduler.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#62E884;">initialize</span><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">        taskRegistrar.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#62E884;">setTaskScheduler</span><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">(threadPoolTaskScheduler);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">}</span></span></code></pre></div><p>æœåŠ¡çƒ­éƒ¨ç½²å®Œæˆåï¼Œä¼šåœ¨æ§åˆ¶å°çœ‹åˆ°è¿™æ ·çš„ä¿¡æ¯ï¼š</p><img src="`+h+'"><p>å¯ä»¥ç¡®è®¤è‡ªå®šä¹‰çº¿ç¨‹æ± å¤§å°å·²ç»ç”Ÿæ•ˆäº†ï¼Œæœ‰çš„ä»»åŠ¡ç”¨çš„æ˜¯çº¿ç¨‹led-task-pool-3ï¼Œæœ‰çš„æ˜¯çº¿ç¨‹led-task-pool-7ï¼Œè·‘æ—¶é—´é•¿äº†ï¼Œå¯ä»¥å‘ç° led-task-pool-1 åˆ° led-task-pool-10 çš„éƒ½æœ‰ã€‚</p><img src="'+l+`"><p>Spring Task é™¤äº†æ”¯æŒ Cron è¡¨è¾¾å¼ï¼Œè¿˜æœ‰ fixedRateï¼ˆå›ºå®šé€Ÿç‡æ‰§è¡Œï¼‰ã€fixedDelayï¼ˆå›ºå®šå»¶è¿Ÿæ‰§è¡Œï¼‰ã€initialDelayï¼ˆåˆå§‹å»¶è¿Ÿï¼‰ä¸‰ç§ç”¨æ³•ã€‚</p><div class="language-java vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki shiki-themes github-light dracula-soft vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7B7F8B;">/**</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7B7F8B;"> * fixedRateï¼šå›ºå®šé€Ÿç‡æ‰§è¡Œã€‚æ¯5ç§’æ‰§è¡Œä¸€æ¬¡ã€‚</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7B7F8B;"> */</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">@</span><span style="--shiki-light:#D73A49;--shiki-dark:#97E1F1;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">Scheduled</span><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#BF9EEE;">fixedRate</span><span style="--shiki-light:#D73A49;--shiki-dark:#F286C4;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#BF9EEE;"> 5000</span><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F286C4;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#97E1F1;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"> void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#62E884;"> reportCurrentTimeWithFixedRate</span><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">() {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">    log.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#62E884;">info</span><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#DEE492;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#E7EE98;">Current Thread : {}</span><span style="--shiki-light:#032F62;--shiki-dark:#DEE492;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">, Thread.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#62E884;">currentThread</span><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">().</span><span style="--shiki-light:#6F42C1;--shiki-dark:#62E884;">getName</span><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">());</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">    log.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#62E884;">info</span><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#DEE492;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#E7EE98;">Fixed Rate Task : The time is now {}</span><span style="--shiki-light:#032F62;--shiki-dark:#DEE492;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">, DateUtil.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#62E884;">now</span><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">());</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7B7F8B;">/**</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7B7F8B;"> * fixedDelayï¼šå›ºå®šå»¶è¿Ÿæ‰§è¡Œã€‚è·ç¦»ä¸Šä¸€æ¬¡è°ƒç”¨æˆåŠŸå2ç§’æ‰æ‰§ã€‚</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7B7F8B;"> */</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">@</span><span style="--shiki-light:#D73A49;--shiki-dark:#97E1F1;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">Scheduled</span><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#BF9EEE;">fixedDelay</span><span style="--shiki-light:#D73A49;--shiki-dark:#F286C4;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#BF9EEE;"> 2000</span><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F286C4;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#97E1F1;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"> void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#62E884;"> reportCurrentTimeWithFixedDelay</span><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">() {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F286C4;">    try</span><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">        TimeUnit.SECONDS.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#62E884;">sleep</span><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#BF9EEE;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">        log.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#62E884;">info</span><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#DEE492;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#E7EE98;">Fixed Delay Task : The time is now {}</span><span style="--shiki-light:#032F62;--shiki-dark:#DEE492;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">,DateUtil.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#62E884;">now</span><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">());</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">    } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F286C4;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;"> (</span><span style="--shiki-light:#24292E;--shiki-dark:#97E1F1;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">InterruptedException</span><span style="--shiki-light:#E36209;--shiki-dark:#FFB86C;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"> e</span><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">        e.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#62E884;">printStackTrace</span><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7B7F8B;">/**</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7B7F8B;"> * initialDelay:åˆå§‹å»¶è¿Ÿã€‚ä»»åŠ¡çš„ç¬¬ä¸€æ¬¡æ‰§è¡Œå°†å»¶è¿Ÿ5ç§’ï¼Œç„¶åå°†ä»¥5ç§’çš„å›ºå®šé—´éš”æ‰§è¡Œã€‚</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#7B7F8B;"> */</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">@</span><span style="--shiki-light:#D73A49;--shiki-dark:#97E1F1;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;">Scheduled</span><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#BF9EEE;">initialDelay</span><span style="--shiki-light:#D73A49;--shiki-dark:#F286C4;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#BF9EEE;"> 5000</span><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#BF9EEE;">fixedRate</span><span style="--shiki-light:#D73A49;--shiki-dark:#F286C4;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#BF9EEE;"> 5000</span><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F286C4;">public</span><span style="--shiki-light:#D73A49;--shiki-dark:#97E1F1;--shiki-light-font-style:inherit;--shiki-dark-font-style:italic;"> void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#62E884;"> reportCurrentTimeWithInitialDelay</span><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">() {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">    log.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#62E884;">info</span><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#DEE492;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#E7EE98;">Fixed Rate Task with Initial Delay : The time is now {}</span><span style="--shiki-light:#032F62;--shiki-dark:#DEE492;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">, DateUtil.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#62E884;">now</span><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">());</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F6F6F4;">}</span></span></code></pre></div><p>ä¸è¿‡ï¼ŒfixedRate æœ‰ä¸ªå‘ï¼Œå‡å¦‚æŸä¸ªæ–¹æ³•çš„å®šæ—¶å™¨è®¾å®šçš„å›ºå®šé€Ÿç‡æ˜¯æ¯5ç§’æ‰§è¡Œä¸€æ¬¡ï¼Œè¿™ä¸ªæ–¹æ³•ç°åœ¨è¦æ‰§è¡Œä¸‹é¢å››ä¸ªä»»åŠ¡ï¼Œå››ä¸ªä»»åŠ¡çš„è€—æ—¶æ˜¯ï¼š6sã€6sã€ 2sã€ 3sï¼Œä»»åŠ¡ä¼šå¦‚ä½•æ‰§è¡Œå‘¢ï¼ˆå•çº¿ç¨‹ç¯å¢ƒä¸‹ï¼‰ï¼Ÿ</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light dracula-soft vp-code"><code><span class="line"><span>2022-04-27 15:25:52.400  INFO 4343 --- [led-task-pool-1] c.codingmore.component.PublishPostTask   : Fixed Rate Task : The time is now 2022-04-27 15:25:52</span></span>
<span class="line"><span>2022-04-27 15:25:58.401  INFO 4343 --- [led-task-pool-1] c.codingmore.component.PublishPostTask   : Fixed Rate Task : The time is now 2022-04-27 15:25:58</span></span>
<span class="line"><span>2022-04-27 15:26:00.407  INFO 4343 --- [led-task-pool-1] c.codingmore.component.PublishPostTask   : Fixed Rate Task : The time is now 2022-04-27 15:26:00</span></span>
<span class="line"><span>2022-04-27 15:26:04.318  INFO 4343 --- [led-task-pool-1] c.codingmore.component.PublishPostTask   : Fixed Rate Task : The time is now 2022-04-27 15:26:04</span></span></code></pre></div><p>ç¬¬ä¸€ä¸ªä»»åŠ¡å¼€å§‹çš„ç›¸å¯¹æ—¶é—´æ˜¯ç¬¬ 0 ç§’ï¼Œä½†ç”±äºæ‰§è¡Œäº† 6 ç§’ï¼Œæ‰€ä»¥åŸæ¥åº”è¯¥æ˜¯ç¬¬ 5 ç§’æ‰§è¡Œçš„ä»»åŠ¡ï¼Œå»¶è¿Ÿåˆ°ç¬¬ 6 ç§’æ‰å¼€å§‹æ‰§è¡Œï¼Œç¬¬ä¸‰ä¸ªä»»åŠ¡å»¶è¿Ÿäº† 12 ç§’ï¼ŒåŸæœ¬åº”è¯¥æ˜¯ç¬¬ 10 ç§’æ‰§è¡Œï¼Œç¬¬ä¸‰ä¸ªä»»åŠ¡æ²¡æœ‰å»¶è¿Ÿï¼Œæ­£å¸¸ 15 ç§’åæ‰§è¡Œã€‚</p><p>å‡å¦‚æˆ‘ä»¬ä½¿ç”¨ @EnableAsync æ³¨è§£å¼€å¯å¤šçº¿ç¨‹ç¯å¢ƒçš„è¯ï¼Œç»“æœä¼šæ€ä¹ˆæ ·å‘¢ï¼Ÿ</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light dracula-soft vp-code"><code><span class="line"><span>2022-04-27 15:33:01.385  INFO 4421 --- [led-task-pool-1] c.codingmore.component.PublishPostTask   : Fixed Rate Task : The time is now 2022-04-27 15:33:01</span></span>
<span class="line"><span>2022-04-27 15:33:07.390  INFO 4421 --- [led-task-pool-1] c.codingmore.component.PublishPostTask   : Fixed Rate Task : The time is now 2022-04-27 15:33:07</span></span>
<span class="line"><span>2022-04-27 15:33:09.391  INFO 4421 --- [led-task-pool-1] c.codingmore.component.PublishPostTask   : Fixed Rate Task : The time is now 2022-04-27 15:33:09</span></span>
<span class="line"><span>2022-04-27 15:33:13.295  INFO 4421 --- [led-task-pool-1] c.codingmore.component.PublishPostTask   : Fixed Rate Task : The time is now 2022-04-27 15:33:13</span></span></code></pre></div><h3 id="å…³äº-cron-è¡¨è¾¾å¼" tabindex="-1">å…³äº Cron è¡¨è¾¾å¼ <a class="header-anchor" href="#å…³äº-cron-è¡¨è¾¾å¼" aria-label="Permalink to &quot;å…³äº Cron è¡¨è¾¾å¼&quot;">â€‹</a></h3><p>è¿™é‡Œé¡ºå¸¦æ™®åŠä¸€ä¸‹ Cron è¡¨è¾¾å¼ï¼Œåœ¨å®šæ—¶ä»»åŠ¡ä¸­ä¼šç»å¸¸ä¼šé‡åˆ°ã€‚Cron è¿™ä¸ªè¯æ¥æºäºå¸Œè…Šè¯­ chronosï¼ŒåŸæ„ä¹Ÿå°±æ˜¯æ—¶é—´ã€‚</p><p>Cron è¡¨è¾¾å¼æ˜¯ä¸€ä¸ªå«æœ‰æ—¶é—´æ„ä¹‰çš„å­—ç¬¦ä¸²ï¼Œä»¥ 5 ä¸ªç©ºæ ¼éš”å¼€ï¼Œåˆ†æˆ 6 ä¸ªæ—¶é—´å…ƒç´ ã€‚ä¸¾å‡ ä¸ªä¾‹å­å°±ä¸€ç›®äº†ç„¶äº†ã€‚</p><table><thead><tr><th>ç¤ºä¾‹</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>0 15 10 ? * *</code></td><td>æ¯å¤©ä¸Šåˆ10:15æ‰§è¡Œä»»åŠ¡</td></tr><tr><td><code>0 0 10,14,16 * * ?</code></td><td>æ¯å¤©10 ç‚¹ã€14 ç‚¹ã€16 ç‚¹æ‰§è¡Œä»»åŠ¡</td></tr><tr><td><code>0 0 12 ? * 3</code></td><td>æ¯ä¸ªæ˜ŸæœŸä¸‰ä¸­åˆ 12 ç‚¹æ‰§è¡Œä»»åŠ¡</td></tr><tr><td><code>0 15 10 15 * ?</code></td><td>æ¯æœˆ 15 æ—¥ä¸Šåˆ 10 ç‚¹ 15 æ‰§è¡Œä»»åŠ¡</td></tr></tbody></table><p>Cron çš„è¯­æ³•æ ¼å¼å¯ä»¥æ€»ç»“ä¸ºï¼š</p><blockquote><p>Seconds Minutes Hours DayofMonth Month DayofWeek</p></blockquote><p>æ¯ä¸ªæ—¶é—´å…ƒç´ çš„å–å€¼èŒƒå›´ï¼Œä»¥åŠå¯å‡ºç°çš„ç‰¹æ®Šå­—ç¬¦å¦‚ä¸‹æ‰€ç¤ºã€‚</p><table><thead><tr><th>æ—¶é—´å…ƒç´ </th><th>å–å€¼èŒƒå›´</th><th>å¯å‡ºç°çš„ç‰¹æ®Šå­—ç¬¦</th></tr></thead><tbody><tr><td>ç§’</td><td><code>[0,59]</code></td><td><code>*,-/</code></td></tr><tr><td>åˆ†é’Ÿ</td><td><code>[0,59]</code></td><td><code>*,-/</code></td></tr><tr><td>å°æ—¶</td><td><code>[0,59]</code></td><td><code>*,-/</code></td></tr><tr><td>æ—¥æœŸ</td><td><code>[0,31]</code></td><td><code>*,-/?LW</code></td></tr><tr><td>æœˆä»½</td><td><code>[1,12]</code></td><td><code>*,-/</code></td></tr><tr><td>æ˜ŸæœŸ</td><td><code>[1,7]</code></td><td><code>*,-/?L#</code></td></tr></tbody></table><p>ç‰¹æ®Šå­—ç¬¦çš„å«ä¹‰å’Œç¤ºä¾‹å¦‚ä¸‹æ‰€ç¤ºã€‚</p><table><thead><tr><th>ç‰¹æ®Šå­—ç¬¦</th><th>å«ä¹‰</th><th>ç¤ºä¾‹</th></tr></thead><tbody><tr><td><code>*</code></td><td>æ‰€æœ‰å¯èƒ½çš„å€¼</td><td>å¾ˆå¥½ç†è§£ï¼ŒæœˆåŸŸä¸­ä¸ºæ¯ä¸ªæœˆï¼Œæ˜ŸæœŸåŸŸä¸­æ¯ä¸ªæ˜ŸæœŸå‡ </td></tr><tr><td><code>,</code></td><td>æšä¸¾çš„å€¼</td><td>å¾ˆå¥½ç†è§£ï¼Œå°æ—¶åŸŸä¸­ <code>10,14,16</code>ï¼Œå°±è¡¨ç¤ºè¿™å‡ ä¸ªå°æ—¶å¯é€‰</td></tr><tr><td><code>-</code></td><td>èŒƒå›´</td><td>å¾ˆå¥½ç†è§£ï¼Œåˆ†é’ŸåŸŸä¸­ <code>10-19</code>ï¼Œå°±è¡¨ç¤º 10-19 åˆ†é’Ÿæ¯éš”ä¸€åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡</td></tr><tr><td><code>/</code></td><td>æŒ‡å®šæ•°å€¼çš„å¢é‡</td><td>å¾ˆå¥½ç†è§£ï¼Œåˆ†é’ŸåŸŸä¸­ <code>0/15</code>ï¼Œå°±è¡¨ç¤ºæ¯éš” 15 åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡</td></tr><tr><td><code>?</code></td><td>ä¸æŒ‡å®šå€¼</td><td>å¾ˆå¥½ç†è§£ï¼Œæ—¥æœŸåŸŸæŒ‡å®šäº†æ˜ŸæœŸåŸŸå°±ä¸èƒ½æŒ‡å®šå€¼ï¼Œåä¹‹äº¦ç„¶ï¼Œå› ä¸ºæ—¥æœŸåŸŸå’Œæ˜ŸæœŸåŸŸå±äºå†²çªå…³ç³»</td></tr><tr><td><code>L</code></td><td>å•è¯ Last çš„é¦–å­—æ¯</td><td>å¾ˆå¥½ç†è§£ï¼Œæ—¥æœŸåŸŸå’Œæ˜ŸæœŸåŸŸæ”¯æŒï¼Œè¡¨ç¤ºæœˆçš„æœ€åä¸€å¤©æˆ–è€…æ˜ŸæœŸçš„æœ€åä¸€å¤©</td></tr><tr><td><code>W</code></td><td>é™¤å‘¨æœ«ä»¥å¤–çš„å·¥ä½œæ—¥</td><td>å¾ˆå¥½ç†è§£ï¼Œä»…æ—¥æœŸåŸŸæ”¯æŒ</td></tr><tr><td><code>#</code></td><td>æ¯ä¸ªæœˆçš„ç¬¬å‡ ä¸ªæ˜ŸæœŸå‡ </td><td>å¾ˆå¥½ç†è§£ï¼Œä»…æ˜ŸæœŸåŸŸæ”¯æŒï¼Œ<code>4#2</code>è¡¨ç¤ºæŸæœˆçš„ç¬¬äºŒä¸ªæ˜ŸæœŸå››</td></tr></tbody></table><h3 id="å°ç»“" tabindex="-1">å°ç»“ <a class="header-anchor" href="#å°ç»“" aria-label="Permalink to &quot;å°ç»“&quot;">â€‹</a></h3><p>Spring Task è™½ç„¶ç”¨èµ·æ¥å¾ˆæ–¹ä¾¿ï¼Œä½†ç”¨æ³•è¿‡å»ç®€å•ï¼Œå¾ˆå¤šå¤æ‚çš„ä¸šåŠ¡é€»è¾‘æ˜¯æ²¡æœ‰åŠæ³•å®ç°çš„ï¼Œæ¯”å¦‚è¯´ç¼–ç¨‹å–µçš„å®šæ—¶å‘å¸ƒæ–‡ç« åŠŸèƒ½ï¼Œåªç”¨ Spring Task æ˜¯æ²¡åŠæ³•çš„ã€‚</p><hr><p>æ›´å¤šå†…å®¹ï¼Œåªé’ˆå¯¹ã€ŠJavaç¨‹åºå‘˜è¿›é˜¶ä¹‹è·¯ã€‹æ˜Ÿçƒç”¨æˆ·å¼€æ”¾ï¼Œéœ€è¦çš„å°ä¼™ä¼´å¯ä»¥<a href="https://tobebetterjavaer.com/zhishixingqiu/" target="_blank" rel="noreferrer">æˆ³é“¾æ¥ğŸ”—</a>åŠ å…¥æˆ‘ä»¬çš„æ˜Ÿçƒï¼Œä¸€èµ·å­¦ä¹ ï¼Œä¸€èµ·å·ã€‚ã€‚<strong>ç¼–ç¨‹å–µ</strong>ğŸ±æ˜¯ä¸€ä¸ª Spring Boot+Vue çš„å‰åç«¯åˆ†ç¦»é¡¹ç›®ï¼Œèåˆäº†å¸‚é¢ä¸Šç»å¤§å¤šæ•°æµè¡Œçš„æŠ€æœ¯è¦ç‚¹ã€‚é€šè¿‡å­¦ä¹ å®æˆ˜é¡¹ç›®ï¼Œä½ å¯ä»¥å°†æ‰€å­¦çš„çŸ¥è¯†é€šè¿‡å®è·µè¿›è¡Œæ£€éªŒã€ä½ å¯ä»¥æ‹“å®½è‡ªå·±çš„æŠ€æœ¯è¾¹ç•Œï¼Œä½ å¯ä»¥æŒæ¡ä¸€ä¸ªçœŸæ­£çš„å®æˆ˜é¡¹ç›®æ˜¯å¦‚ä½•ä» 0 åˆ° 1 çš„ã€‚</p><hr><h3 id="æºç è·¯å¾„" tabindex="-1">æºç è·¯å¾„ <a class="header-anchor" href="#æºç è·¯å¾„" aria-label="Permalink to &quot;æºç è·¯å¾„&quot;">â€‹</a></h3><blockquote><ul><li>ç¼–ç¨‹å–µï¼š<a href="https://github.com/itwanger/coding-more" target="_blank" rel="noreferrer">https://github.com/itwanger/coding-more</a></li><li>codingmore-springtaskï¼š<a href="https://github.com/itwanger/codingmore-learning/tree/main/codingmore-springtask" target="_blank" rel="noreferrer">https://github.com/itwanger/codingmore-learning</a></li></ul></blockquote>`,53),p=[e];function d(r,F,o,g,c,y){return a(),i("div",null,p)}const C=s(k,[["render",d]]);export{u as __pageData,C as default};
